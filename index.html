<!DOCTYPE html>

<html lang="en" xmlns="http://www.w3.org/1999/xhtml">
<head>
    <!--<script src="./js/error_dialog.js" charset="ISO-8859-1"></script>-->
    <meta charset="utf-8" />
    <link rel="stylesheet" href="css/general.css" type="text/css">
    <link rel="stylesheet" href="css/responsive.css" type="text/css">
    <meta meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <script src="js/Icons.js" crossorigin="anonymous"></script>
    <script src="js/Api.js" type="module"  ></script>
    <script src="js/Book.js" type="module" ></script>
    <script src="js/Fetch.js" type="module" ></script>

    <!--<link rel="shortcut icon" href="./img/Loto_icon.png">-->

    <title>Biblioteca</title>

</head>

<body>
    <section class="site-title-bar">
        <section class="container container-flex">
            <h1>Tecno Library</h1>
            <article class="login-section">
                <article class="input user">
                    <i class="fas fa-user" style="font-size:24px;"></i>
                    <input class="input-text" id="txtemail" type="text" placeholder="Correo" />
                </article>
                <article class="input pass">
                    <i class="fas fa-lock" style="font-size:24px;"></i>
                    <input class="input-text" id="txtpassword" type="password" placeholder="Contraseña" />
                </article>
                <article>
                    <button id="btnlogin">Iniciar</button>
                    <a href="#">Registrate</a>
                </article>
            </article>
            <!--Sección oculta unicamente para celular-->
            <section class="login-section-responsive">
                <i class="fas fa-user" id="user-icon" style="font-size:24px;"></i>
            </section>
        </section>
    </section>

    <header>
        <section class="container site-search">
            <section class="site-search-background">
                <h1>Probando colores blancos</h1>
                <h2>Algún eslogan</h2>
                <p>Algún comentario antes del buscador</p>
                <article class="search-input-button">
                    <input id="txtSearch" type="text" placeholder="Título, autor o palabra clave" />
                    <button id="btnSearch">Buscar</button>
                </article>
            </section>
        </section>
    </header>

    <section class="most-relevant">
        <section class="container">
            <h3 id="busqueda">Más destacados</h3>
        </section>
    </section>

    <section class="list-books container" id="bookList"></section>


    <script>
        // SCRIPT PARA LOS ADD-EVENT-LISTENER
        var activarBusqueda = document.getElementById("txtSearch");
        activarBusqueda.addEventListener("keyup", (event) => {
            if (event.keyCode === 13) {

                txtSearch = document.getElementById('txtSearch')

                apiObject.searchBooks(txtSearch.value)

                let array = apiObject.getData()
                console.log(array)


                let arrayBook = Array();

                for (x = 0; x < array.length; x++) {
                    arrayBook[x] = new Book();
                    arrayBook[x].createBook("bookList", array[x]);
                }
            }
        })

        var actBarraBusqueda = document.getElementById("search-icon");
        actBarraBusqueda.addEventListener('click', event => {
            if (screen.width < 680) {
                activarBusqueda.style.display = "block";
            }
        })


    </script>

   
    <script type="module">

        import Api from './js/Api.js'
        import Fetch from './js/Fetch.js'    

        document.getElementById('btnSearch').
        addEventListener('click', 
            event => {
                let txtSearch = document.getElementById('txtSearch')
                
                
                let api = new Api()
                api.searchBooks(txtSearch.value)

                let url = api.getUrl()
                Fetch(url, "bookList") //Función que viene de.; ./js/Fetch.js

            }    
        )
        

    </script> 

    <script>
         /* Inicio de sesion  (Leer valores) */

            document.getElementById("btnlogin").addEventListener("click", event => {

            let myEmail = document.getElementById("txtemail").value
            let myPassword = document.getElementById("txtpassword").value 

            let params = new URLSearchParams(
                {
                    email:myEmail,
                    password:myPassword
                }
            ).toString();

            fetch("http://localhost/api-library/php/classes/testing.php?"+params).
            then(
                res=>res.json()
            ).then(
                data=>{console.log(data)}
            )   
        })

    </script>

</body>
</html>